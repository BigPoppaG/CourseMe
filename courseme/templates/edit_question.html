{% extends "layout.html" %}
{% block content %}

<!--<!DOCTYPE html>
<html>
<head>
<title>MathJax Dynamic Math Test Page</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />-->

<!--<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>-->
<script type="text/javascript" src="/static/lib/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>

<script type='text/javascript'>
$(document).ready(function () {

    $(function() {

        $('#define_objectives').find('.dynamic-list-new-item-label').text("Enter new objective for this question");
        $('#define_objectives').find('.dynamic-list-heading').text("Objectives");        
                
        var availableTags = [];
        {% for objective in objectives %}
            availableTags.push('{{ objective.name }}')    
        {% endfor %}    

        $("#define_objectives").find(".dynamic-list-new-item").autocomplete({
            source: availableTags
        });
        
        $("#new_prerequisite_form_group").find(".dynamic-list-new-item").autocomplete({
            source: availableTags
        });
        
        questionObjectives = [];
        {% for objective in question_objectives %}
            questionObjectives.push('{{ objective.name }}')    
        {% endfor %}    
        dynamicList_addList(questionObjectives, $("#define_objectives"));
    
        if ({{edit_id}}>0) {
          //DJG - hit the test button
          console.log('hit test question');
          testQuestion();
        }
          
    });


    
    $("#test_question").click(function(event){
        event.preventDefault();     //DJG - don't want submit button to post the form as well as the ajax request or get 400 bad request error. Not sure if this is the right way to fix it.
        testQuestion();   
    });

    $("#clear_question").click(function(event){
        event.preventDefault();     //DJG - don't want submit button to post the form as well as the ajax request or get 400 bad request error. Not sure if this is the right way to fix it.
        console.log('clear question');
        $("#test_question_output").html("");
        $("#question").val("");
        $("#question_test_display").addClass("hidden");
    });

    $("#clear_answer").click(function(event){
        event.preventDefault();     //DJG - don't want submit button to post the form as well as the ajax request or get 400 bad request error. Not sure if this is the right way to fix it.
        console.log('clear answer');
        $("#test_answer_output").html("");
        $("#answer").val("");    
        $("#answer_test_display").addClass("hidden");
    });

    $(".delete-question").click(function(event){
        event.preventDefault();     //DJG - don't want submit button to post the form as well as the ajax request or get 400 bad request error. Not sure if this is the right way to fix it.

        edit_id = {{edit_id}}
        $.getJSON(flask_util.url_for('delete_question', {id: edit_id }),
            function(result) {
                if(result.savedsuccess)
                {
                    window.location.href = flask_util.url_for('questions');
                }
                else
                {       
                    window.location.reload();
                }
            }
        )
    });
    
})

function testQuestion() {
    $("#test_question_output").html($("#question").val());
    $("#test_answer_output").html($("#answer").val());        
    MathJax.Hub.Queue(["Typeset",MathJax.Hub],"test_question_output");
    MathJax.Hub.Queue(["Typeset",MathJax.Hub],"test_answer_output");
    $("#question_test_display").removeClass("hidden");
    $("#answer_test_display").removeClass("hidden");
    return false;
}    
    
</script>


<h2>{{form_header}}</h2>

<div class="row">
  <div class="col-md-12">

    <form class="form" action={{ url_for('edit_question', id=0) }} method="POST" id="edit_question_form">
        {{ form.hidden_tag() }}
        {{ form.edit_question_id }}
        <div class="form-group" id="question_form_group">
            {{ form.question.label }}
            {{ form.question(placeholder="Enter Question", class="form-control") }}
            <p class="help-block" id="error_question"></p>
        </div>
        <div class="form-group">  
          <div id="question_test_display" class="panel panel-default hidden">
            <div class="panel-body">
                <p id="test_question_output"></p>
            </div>
          </div>
          <button id="clear_question" class="btn btn-default btn-sm pull-right" type="cancel">Clear Question</button>       <!--DJG - don't understand type attribute of buttons-->
        </div>
        <div class="form-group" id="answer_form_group">
            {{ form.answer.label }}
            {{ form.answer(placeholder="Enter Answer", class="form-control") }}
            <p class="help-block" id="error_answer"></p>
        </div>
        <div class="form-group">  
          <div id="answer_test_display" class="panel panel-default hidden">
            <div class="panel-body">
                <p id="test_answer_output"></p>
            </div>
          </div>
          <button id="clear_answer" class="btn btn-default btn-sm pull-right" type="cancel">Clear Answer</button>
        </div>
        
        <div id="special_features" class="form-group">
          <label class="btn btn-info">
              {{ form.extension.label }}
              {{ form.extension }}
          </label>        
        </div>
        
        <div class="form-group">
            <div class="dynamic-list-container" id="define_objectives">
                {% with dynamic_list_select=form.question_objectives %}
                {% include "subplates/dynamic-list.html" %}
                {% endwith %}
            </div>
            <button class="btn btn-sm btn-success pull-right" id="create_objective">Create New Objective</button>
        </div>
        
        <button id="test_question" class="btn btn-success" type="submit">Test</button>        
        <button id="save_question" class="btn btn-success" type="submit">Save</button>
        <button id="delete_question" class="btn btn-danger delete-question{% if edit_id == 0 %} hidden{% endif %}" type="cancel">Delete</button>
    </form>
  {% include "subplates/edit-objective-modal.html" %}
  </div>    
</div>

<hr>
<h2>Some Latex examples hardcocded onto the page</h2>
<div class="math-header">A Cross Product Formula</div>

\[\mathbf{V}_1 \times \mathbf{V}_2 =  \begin{vmatrix}
\mathbf{i} &amp; \mathbf{j} &amp; \mathbf{k} \\
\frac{\partial X}{\partial u} &amp;  \frac{\partial Y}{\partial u} &amp; 0 \\
\frac{\partial X}{\partial v} &amp;  \frac{\partial Y}{\partial v} &amp; 0
\end{vmatrix}  \]

<div class="math-header">The probability of getting \(k\) heads when flipping \(n\) coins is</div>

\[P(E)   = {n \choose k} p^k (1-p)^{ n-k} \]

<div class="math-header">An Identity of Ramanujan</div>

\[ \frac{1}{\Bigl(\sqrt{\phi \sqrt{5}}-\phi\Bigr) e^{\frac25 \pi}} =
1+\frac{e^{-2\pi}} {1+\frac{e^{-4\pi}} {1+\frac{e^{-6\pi}}
{1+\frac{e^{-8\pi}} {1+\ldots} } } } \]

<div class="math-header">A Rogers-Ramanujan Identity</div>

\[  1 +  \frac{q^2}{(1-q)}+\frac{q^6}{(1-q)(1-q^2)}+\cdots =
\prod_{j=0}^{\infty}\frac{1}{(1-q^{5j+2})(1-q^{5j+3})},
\quad\quad \text{for $|q|&lt;1$}. \]

<div class="math-header">Maxwell&#8217;s Equations</div>
<p>
\[  \begin{aligned}
\nabla \times \vec{\mathbf{B}} -\, \frac1c\, \frac{\partial\vec{\mathbf{E}}}{\partial t} &amp; = \frac{4\pi}{c}\vec{\mathbf{j}} \\
\nabla \cdot \vec{\mathbf{E}} &amp; = 4 \pi \rho \\
\nabla \times \vec{\mathbf{E}}\, +\, \frac1c\, \frac{\partial\vec{\mathbf{B}}}{\partial t} &amp; = \vec{\mathbf{0}} \\
\nabla \cdot \vec{\mathbf{B}} &amp; = 0 \end{aligned}
\]
</p>
<p>Finally, while display equations look good for a page of samples, the ability to mix math and text in a paragraph is also important. This expression \(\sqrt{3x-1}+(1+x)^2\) is an example of an inline equation.  As you see, MathJax equations can be used this way as well, without unduly disturbing the spacing between lines.</p>
<br>


{% endblock %}
