{% extends "layout.html" %}
{% block content %}

<script type='text/javascript'>
$(document).ready(function () {

    //Button per objective to mark the corresponding objective as assessed
    $(".mark_assessed").on('click', function () {
        cell = this
        var objective_id = cell.id.split('_')[0]
        console.log("assess objective " + objective_id + " clicked")
        $.getJSON(
            flask_util.url_for('objective_assess', {profile_id: {{profile.id}}, objective_id: objective_id}), 
            function(result) {
                if (result.completed) {
                    $(cell).addClass("success")
                }
                else {
                    $(cell).removeClass("success")
                } 
            }
        );
    });


})
</script>

<h1>{{profile.name}} Progress</h1>

<table class="table table-condensed">
    <tr>
      <th></th>
      <th class="DJG_rotate_headers">{% if profile == g.user %}Self Assessment{% elif profile.institution_student and profile.institution_student.is_member(g.user) %}{{profile.institution_student.name}} Assessment{% else %}Your Assessment{% endif %}</th> 
      <th class="hidden">CourseMe Assessment</th>
      <th class="{% if profile == g.user and not profile.institution_student %}hidden{% endif %}">{% if profile == g.user and profile.institution_student %}{{profile.institution_student.name}} Assessment{% else %}Self Assessment{% endif %}</th>
    </tr>
{% for objective in objectives %}    
    <tr>
        <td>{{objective.name}}</td>
        <td id="{{ objective.id ~ '_assess' }}" class="mark_assessed{% if objective.assessed(profile, g.user) %} success{% endif %}"></td>
        <td class="hidden"></td>
        <td class="{% if profile == g.user and not profile.institution_student %}hidden{% elif profile == g.user and objective.assessed(profile, profile.institution_student.creator) %} info{% elif profile != g.user and objective.assessed(profile, profile) %} info{% endif %}"></td>
    </tr>
{% endfor %}
    
</table>


{% endblock %}